package com.malwarebytes.kafka;

import org.apache.kafka.clients.producer.MockProducer;
import org.apache.kafka.common.serialization.StringSerializer;
import org.junit.jupiter.api.Assertions;
import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.Test;

public class KafkaApiTest {
    private  KafkaApi<String> kafkaApi;
    MockProducer mockProducer = new MockProducer<>(true, new StringSerializer(), new StringSerializer());

    @BeforeEach
    public void setup() throws Exception{
        kafkaApi = new KafkaApi<>(mockProducer, "test_test");
    }


    @Test
    public void test_KafkaMessageSent(){
        kafkaApi.send("hello");
        Assertions.assertEquals(mockProducer.history().size(), 1);
    }
}
